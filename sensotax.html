<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√ñl Sensorisk Taxonomi</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            padding: 15px;
        }
        .niva1 {
            padding: 12px;
            margin-top: 15px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 1.2em;
            font-weight: bold;
            color: white; /* Textf√§rg alltid vit p√• Niv√• 1 */
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
        }
        .niva1-icon {
            font-size: 1.4em;
            margin-right: 10px;
        }
        .niva2 {
            background-color: #ffffff;
            color: #333;
            padding: 10px 15px;
            margin-top: 3px;
            cursor: pointer;
            border-bottom: 1px solid #ddd;
            font-weight: 600;
            transition: background-color 0.1s;
        }
        .niva2:hover {
            background-color: #f0f0f0;
        }
        .niva3 {
            list-style-type: none;
            margin: 0;
            padding: 5px 20px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-top: none;
            padding: 10px 15px;
            font-size: 0.9em;
            /* display: none; tas bort av JS f√∂r initial expansion */
        }
        .niva3 li {
            padding: 3px 0;
            border-bottom: 1px dotted #eee;
        }
        .niva3 li:last-child {
            border-bottom: none;
        }
        .rubrik {
            text-align: center;
            color: #2a6fdb;
            margin-bottom: 30px;
        }
    </style>
    <link rel="manifest" href="manifest.webmanifest">
</head>
<body>

<div class="rubrik">
    <h1>√ñL SENSORISK TAXONOMI</h1>
    <p>V√§rderingsneutral hierarki (Niv√• 1 ‚Üí Niv√• 2 ‚Üí Niv√• 3)</p>
</div>

<div id="taxonomi-container">
    </div>

<script>
// === DATAMODEL & STILAR ===
const data = {
    'A_Fruktig_och_Ester_relaterad': {
        'Citrus': ['Grapefrukt', 'Apelsin', 'Citron', 'Lime', 'Mandarin', 'Bergamott', 'Pompelmus', 'Citronskal'],
        'Stenfrukt_och_Karnfrukt': ['Persika', 'Aprikos', 'Plommon', 'Nektarin', 'K√∂rsb√§r', '√Ñpple', 'P√§ron', 'Banan', 'Ros√©'],
        'Tropisk_och_Exotisk_Frukt': ['Mango', 'Passionsfrukt', 'Ananas', 'Guava', 'Papaya', 'Litchi', 'Kiwi', 'Kokosn√∂t', 'Vattenmelon', 'Honungsmelon', 'Cantaloupe-melon'],
        'B√§r_och_Vinb√§r': ['Svarta vinb√§r', 'Bl√•b√§r', 'Hallon', 'Bj√∂rnb√§r', 'Jordgubbe', 'R√∂da vinb√§r', 'Krusb√§r'],
        'Torkad_och_M√∂rk_Frukt': ['Russin', 'Torkad frukt'],
        '√Öldring_och_Oxidationstoner': ['Sherry/Vin√∂s', 'Oxidativ', 'Kartong/V√•t papp', 'Gr√∂n']
    },
    'B_Kryddig_Floral_och_Vegetal': {
        'Kryddig': ['Peppar', 'Kryddnejlika', 'Anis', 'Muskot', 'Ingef√§ra', 'Lakrits', 'Enb√§r'],
        'Floral_Blommig': ['Ros', 'Geranium', 'Syren', 'Jasmin', 'Fl√§der', 'Kamomill', 'Lavendel', 'Apelsinblom'],
        '√ñrtig_Aromatisk': ['Dill', 'Timjan', 'Basilika', 'Rosmarin', 'Mynta', 'Gr√∂nmynta', 'Gr√∂n te', 'Svart te', 'Mejram'],
        'Gr√∂n_och_Vegetal': ['Gr√§sig', 'Nyklippt gr√§s', 'L√∂k', 'Vitl√∂k', 'Selleri', 'N√§ssla', 'Gurka', 'DMS', 'Kokt k√•l', 'Majs'],
        'Ofr√§sch_Vegetal': ['Ruttet √§gg', 'Skunkig', 'Catty']
    },
    'C_Spannmal_och_S√∂tma': {
        'Basmalt_och_Br√∂dig': ['Maltig', 'Korn', 'Br√∂dig', 'Degig', 'Cracker', 'Varm', 'Kaka/Kex', 'Br√∂dskorpa'],
        'Karamell_och_Sirap': ['Karamell', 'Kola', 'Toffee', 'Kn√§ck', 'Sirap', 'Farinsocker', 'Melass', 'Fudge', 'Br√§nt socker', 'Karamelliserad l√∂k'],
        'Enkel_S√∂tma_och_N√∂t': ['L√§tt s√∂tma', 'Honung', 'Socker', 'Vanilj', 'Mandel/Marsipan', 'Hasseln√∂t', 'Valn√∂t', 'Jordn√∂t', 'Oljig'],
        'Torr_och_R√•': ['Torr', 'H√∂', 'Halm', 'Kornig', 'Mj√∂lig'],
        'Sm√∂rig': ['Sm√∂rig', 'Popcorn', 'H√§rskt/Sm√∂rigt']
    },
    'D_Rostad_och_Br√§nd': {
        'Kaffe_och_Choklad': ['Kaffe', 'Espresso', 'Choklad', 'M√∂rk choklad', 'Mj√∂lkchoklad', 'Kakao', 'Nygjord kaffe'],
        'Br√§nd_och_Sotig': ['Br√§nd', 'Sotig', 'Bitter Choklad', 'Br√§nd sockervadd'],
        'R√∂kig': ['R√∂ksmak', 'Torvig', 'L√§tt R√∂k', 'Skinka/Bacon']
    },
    'E_Komplex_Oorganisk_och_Fenolisk': {
        'K√•da_och_Tall': ['K√•dig', 'Tall', 'Cedertr√§'],
        'Jordig': ['Jordig', 'Mossa/Svamp', 'Doff', 'Smutsig/Jordig'],
        'Tr√§_och_Alkohol': ['Tr√§ig', 'Tobak', 'L√§der', 'R√∂kelse', 'Kognak/Barrique', 'V√§rmande/Spritig', 'L√∂sningsmedel', 'Pl√•ster/Medicinsk', 'Fenolisk'],
        'Infektion_och_Syra': ['Vin√§ger/Sur', 'Sur/Mj√∂lksyra', 'H√§stt√§cke/Stall', 'Ostig', 'Klor/Klorfenol'],
        'Mineral_och_Oorganisk': ['Metallisk', 'Blodig', 'Kemisk', 'T√§ndsticka/R√∂k']
    },
    'G_Munk√§nsla_Textur_och_Eftersmak': {
        'Taktil_K√§nsla_Kropp': ['Fyllig/T√§t', 'Medium fyllighet', 'L√§tt/Vattnig', 'Silkeslen/Mjuk', 'Oljig/Fet', 'Str√§v'],
        'Kolsyra_och_Skum': ['Kraftig/H√∂gt kolsyrad', 'L√•g/Platt', 'Mjuk/P√§rlande', 'Skummig/Mousserande', 'Tunn/F√∂rsvinnande skum'],
        'Termisk_och_Alkohol': ['Kylande', 'Stickande'],
        'Grundsmaker': ['Besk', 'S√∂t', 'Salt'],
        'Eftersmak': ['Kvardr√∂jande', 'Ren/Kort', 'Klibbig/Seg', 'Bel√§ggande']
    }
};

const categoryStyles = {
    'A_Fruktig_och_Ester_relaterad': { color: '#FF5733', icon: 'üçä' }, // Ljus orange/r√∂d f√∂r frukt
    'B_Kryddig_Floral_och_Vegetal': { color: '#32CD32', icon: 'üåø' }, // Ljusgr√∂n f√∂r det vegetala
    'C_Spannmal_och_S√∂tma': { color: '#DAA520', icon: 'üçû' }, // Gyllengul/Halmf√§rg f√∂r spannm√•l
    'D_Rostad_och_Br√§nd': { color: '#654321', icon: '‚òï' }, // M√∂rkbrun f√∂r rostat/kaffe
    'E_Komplex_Oorganisk_och_Fenolisk': { color: '#808080', icon: 'üå≤' }, // Gr√•/gr√∂n f√∂r k√•da, tr√§ och kemiskt
    'G_Munk√§nsla_Textur_och_Eftersmak': { color: '#2a6fdb', icon: 'üíß' }  // Bl√• f√∂r vatten/k√§nsla
};

const container = document.getElementById('taxonomi-container');

// === FUNKTIONER ===

function replaceKey(key) {
    // Ers√§tter A_Fruktig_och_Ester_relaterad med A. Fruktig och Ester-relaterad
    return key.replace(/_/g, ' ').replace(/(.)\s(\w+)/, (match, p1, p2) => `${p1}. ${p2}`);
}

function generateTaxonomy() {
    for (const niva1Key in data) {
        const style = categoryStyles[niva1Key] || { color: '#000000', icon: '?' };

        // 1. Skapa Niv√• 1-element
        const niva1Div = document.createElement('div');
        niva1Div.className = 'niva1';
        niva1Div.style.backgroundColor = style.color;
        
        const iconSpan = document.createElement('span');
        iconSpan.className = 'niva1-icon';
        iconSpan.textContent = style.icon;
        niva1Div.appendChild(iconSpan);
        
        niva1Div.appendChild(document.createTextNode(replaceKey(niva1Key)));
        container.appendChild(niva1Div);

        // 2. Skapa container f√∂r Niv√• 2-kategorier (VISIBEL SOM STANDARD)
        const niva2Container = document.createElement('div');
        niva2Container.style.display = 'block'; // S√§tts till 'block' f√∂r initial expansion
        container.appendChild(niva2Container);

        for (const niva2Key in data[niva1Key]) {
            // 3. Skapa Niv√• 2-element
            const niva2Div = document.createElement('div');
            niva2Div.className = 'niva2';
            niva2Div.style.borderLeftColor = style.color; // F√§rgmatchande border
            niva2Div.textContent = niva2Key.replace(/_/g, ' ');
            niva2Container.appendChild(niva2Div);

            // 4. Skapa Niv√• 3-element
            const niva3Ul = document.createElement('ul');
            niva3Ul.className = 'niva3';
            niva3Ul.style.display = 'none'; // Niv√• 3 √§r dold som standard
            data[niva1Key][niva2Key].forEach(term => {
                const li = document.createElement('li');
                li.textContent = term;
                niva3Ul.appendChild(li);
            });
            niva2Container.appendChild(niva3Ul);

            // Klickh√§ndelse f√∂r Niv√• 2 (visar/d√∂ljer Niv√• 3)
            niva2Div.addEventListener('click', function() {
                const nextNiva3 = this.nextElementSibling;
                if (nextNiva3 && nextNiva3.classList.contains('niva3')) {
                    nextNiva3.style.display = nextNiva3.style.display === 'none' ? 'block' : 'none';
                }
            });
        }

        // Klickh√§ndelse f√∂r Niv√• 1 (visar/d√∂ljer Niv√• 2-containern)
        niva1Div.addEventListener('click', function() {
            const nextContainer = this.nextElementSibling;
            if (nextContainer) {
                nextContainer.style.display = nextContainer.style.display === 'none' ? 'block' : 'none';
                
                // Om Niv√• 1 d√∂ljs, d√∂lj √§ven alla Niv√• 3-listor i den
                if (nextContainer.style.display === 'none') {
                    nextContainer.querySelectorAll('.niva3').forEach(ul => {
                        ul.style.display = 'none';
                    });
                }
            }
        });
    }
}

// Service Worker-registrering (Endast om du hostar den)
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js');
    });
}

generateTaxonomy();
</script>

</body>
</html>
